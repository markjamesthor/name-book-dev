<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>배경 제거 프로토타입</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
            background: #0f0f0f;
            color: #e0e0e0;
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 24px;
        }

        header {
            text-align: center;
            padding: 20px 0 16px;
            border-bottom: 1px solid #2a2a2a;
            margin-bottom: 24px;
        }

        header h1 {
            font-size: 22px;
            font-weight: 600;
            color: #fff;
        }

        header p {
            font-size: 13px;
            color: #888;
            margin-top: 4px;
        }

        /* Upload Area */
        .upload-area {
            border: 2px dashed #3a3a3a;
            border-radius: 12px;
            padding: 48px 24px;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s;
            background: #1a1a1a;
            margin-bottom: 20px;
        }

        .upload-area:hover,
        .upload-area.dragover {
            border-color: #4a9eff;
            background: #1a2a3a;
        }

        .upload-area .icon {
            font-size: 40px;
            margin-bottom: 12px;
        }

        .upload-area .label {
            font-size: 15px;
            color: #bbb;
        }

        .upload-area .hint {
            font-size: 12px;
            color: #666;
            margin-top: 6px;
        }

        .upload-area.has-file {
            padding: 16px 24px;
            border-style: solid;
            border-color: #333;
        }

        .upload-area.has-file .icon { font-size: 20px; margin-bottom: 0; }
        .upload-area.has-file .label { font-size: 13px; }
        .upload-area.has-file .hint { display: none; }

        .file-info {
            display: none;
            align-items: center;
            gap: 12px;
            justify-content: center;
        }

        .upload-area.has-file .file-info { display: flex; }
        .upload-area.has-file .upload-prompt { display: none; }

        .file-info .file-name {
            font-size: 14px;
            color: #ccc;
        }

        .file-info .change-btn {
            font-size: 12px;
            color: #4a9eff;
            cursor: pointer;
            text-decoration: underline;
        }

        /* Controls */
        .controls {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr 1fr 1fr;
            gap: 20px;
            align-items: end;
            margin-bottom: 24px;
            background: #1a1a1a;
            border-radius: 12px;
            padding: 20px;
            border: 1px solid #2a2a2a;
        }

        .control-group label {
            display: block;
            font-size: 12px;
            font-weight: 600;
            color: #999;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 10px;
        }

        .model-options {
            display: flex;
            gap: 6px;
            flex-wrap: wrap;
        }

        .model-options input[type="radio"] { display: none; }

        .model-options .model-label {
            display: inline-block;
            padding: 6px 14px;
            border-radius: 6px;
            font-size: 13px;
            cursor: pointer;
            border: 1px solid #3a3a3a;
            background: #222;
            color: #bbb;
            transition: all 0.15s;
        }

        .model-options input[type="radio"]:checked + .model-label {
            background: #4a9eff;
            border-color: #4a9eff;
            color: #fff;
        }

        .model-options .model-label:hover {
            border-color: #555;
        }

        .resolution-control {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .resolution-control input[type="range"] {
            flex: 1;
            accent-color: #4a9eff;
            height: 6px;
        }

        .resolution-control .res-value {
            font-size: 14px;
            font-weight: 600;
            color: #4a9eff;
            min-width: 60px;
            text-align: right;
        }

        .original-toggle {
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 13px;
            color: #bbb;
            cursor: pointer;
            user-select: none;
            margin-left: 4px;
        }

        .original-toggle input[type="checkbox"] {
            accent-color: #4a9eff;
            width: 15px;
            height: 15px;
        }

        .resolution-control.disabled input[type="range"] {
            opacity: 0.3;
            pointer-events: none;
        }

        .resolution-control.disabled .res-value {
            opacity: 0.3;
        }

        /* Compare Section */
        .compare-section {
            display: none;
            grid-template-columns: 1fr 1fr;
            gap: 16px;
            margin-bottom: 24px;
        }

        .compare-section.visible { display: grid; }


        .compare-card {
            background: #1a1a1a;
            border: 1px solid #2a2a2a;
            border-radius: 12px;
            overflow: hidden;
        }

        .compare-card .card-title {
            padding: 10px 16px;
            font-size: 12px;
            font-weight: 600;
            color: #888;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            border-bottom: 1px solid #2a2a2a;
        }

        .compare-card .card-body {
            padding: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 300px;
            position: relative;
        }

        .compare-card .card-body img,
        .compare-card .card-body canvas {
            max-width: 100%;
            max-height: 400px;
            object-fit: contain;
        }

        /* Checkerboard background for transparency */
        .checker-bg {
            background-image:
                linear-gradient(45deg, #2a2a2a 25%, transparent 25%),
                linear-gradient(-45deg, #2a2a2a 25%, transparent 25%),
                linear-gradient(45deg, transparent 75%, #2a2a2a 75%),
                linear-gradient(-45deg, transparent 75%, #2a2a2a 75%);
            background-size: 16px 16px;
            background-position: 0 0, 0 8px, 8px -8px, -8px 0px;
            background-color: #1e1e1e;
        }

        /* Preview Section */
        .preview-section {
            display: none;
            margin-bottom: 24px;
        }

        .preview-section.visible { display: block; }

        .preview-section .section-title {
            font-size: 12px;
            font-weight: 600;
            color: #888;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 12px;
        }

        .preview-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 12px;
        }

        .preview-card {
            border-radius: 10px;
            overflow: hidden;
            border: 1px solid #2a2a2a;
        }

        .preview-card .preview-label {
            padding: 8px 12px;
            font-size: 11px;
            font-weight: 600;
            color: #888;
            text-align: center;
            background: #1a1a1a;
            border-bottom: 1px solid #2a2a2a;
        }

        .preview-card canvas {
            display: block;
            width: 100%;
            height: auto;
        }

        /* BGQA Badge */
        .bgqa-badge {
            display: none;
            align-items: center;
            gap: 8px;
            padding: 8px 14px;
            border-radius: 8px;
            font-size: 13px;
            font-weight: 600;
            margin-bottom: 16px;
        }

        .bgqa-badge.visible { display: inline-flex; }
        .bgqa-badge.pass { background: #1a3a1a; color: #4caf50; border: 1px solid #2a5a2a; }
        .bgqa-badge.fail { background: #3a1a1a; color: #f44336; border: 1px solid #5a2a2a; }

        /* Processing Info */
        .processing-info {
            display: none;
            font-size: 12px;
            color: #666;
            margin-bottom: 16px;
        }

        .processing-info.visible { display: block; }

        /* Download */
        .download-section {
            display: none;
            text-align: center;
            padding: 16px 0;
        }

        .download-section.visible { display: block; }

        .download-btn {
            padding: 12px 32px;
            background: #2a8a4a;
            color: #fff;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.15s;
        }

        .download-btn:hover { background: #238a42; }

        .download-crop-btn {
            background: #6a1b9a;
            margin-left: 12px;
        }
        .download-crop-btn:hover { background: #7b1fa2; }

        /* Loading Overlay */
        .loading-overlay {
            display: none;
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.7);
            z-index: 100;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            gap: 16px;
        }

        .loading-overlay.visible {
            display: flex;
        }

        .spinner {
            width: 40px;
            height: 40px;
            border: 3px solid #333;
            border-top-color: #4a9eff;
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
        }

        @keyframes spin { to { transform: rotate(360deg); } }

        .loading-overlay .loading-text {
            font-size: 14px;
            color: #ccc;
        }

        .loading-overlay .loading-time {
            font-size: 12px;
            color: #888;
        }

        /* Error */
        .error-message {
            display: none;
            background: #3a1a1a;
            border: 1px solid #5a2a2a;
            border-radius: 8px;
            padding: 12px 16px;
            color: #f44336;
            font-size: 13px;
            margin-bottom: 16px;
        }

        .error-message.visible { display: block; }
        /* SAM2 Pipeline */
        .sam2-pipeline { display: none; margin-bottom: 24px; }
        .sam2-pipeline.visible { display: block; }

        .pipeline-title {
            font-size: 12px; font-weight: 600; color: #888;
            text-transform: uppercase; letter-spacing: 0.5px;
            margin-bottom: 12px;
        }

        .pipeline-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 12px;
        }

        .pipeline-card {
            background: #1a1a1a;
            border: 1px solid #2a2a2a;
            border-radius: 10px;
            overflow: hidden;
            opacity: 0.35;
            transition: opacity 0.3s, border-color 0.3s;
        }
        .pipeline-card.active {
            opacity: 1;
            border-color: #4a9eff;
        }
        .pipeline-card.done {
            opacity: 1;
            border-color: #3a3a3a;
        }
        .pipeline-card.awaiting {
            opacity: 1;
            border-color: #ffd54f;
        }
        .pipeline-card.awaiting .step-num {
            background: #ffd54f;
            color: #000;
        }
        .pipeline-card.awaiting .card-body .mini-spinner {
            display: none;
        }
        .pipeline-card.awaiting .card-body canvas {
            display: block;
            cursor: pointer;
        }

        .pipeline-card .card-header {
            display: flex; align-items: center; gap: 8px;
            padding: 8px 12px;
            border-bottom: 1px solid #2a2a2a;
        }

        .pipeline-card .step-num {
            display: inline-flex; align-items: center; justify-content: center;
            width: 20px; height: 20px; border-radius: 50%;
            background: #333; color: #666;
            font-size: 11px; font-weight: 700;
            flex-shrink: 0;
        }
        .pipeline-card.active .step-num { background: #4a9eff; color: #fff; }
        .pipeline-card.done .step-num { background: #4caf50; color: #fff; }

        .pipeline-card .step-title {
            font-size: 11px; font-weight: 600; color: #666;
        }
        .pipeline-card.active .step-title,
        .pipeline-card.done .step-title { color: #bbb; }

        .pipeline-card .step-status {
            margin-left: auto; font-size: 10px; color: #555;
        }
        .pipeline-card.done .step-status { color: #4caf50; }

        .pipeline-card .card-body {
            padding: 8px; display: flex; align-items: center; justify-content: center;
            min-height: 180px; position: relative;
        }
        .pipeline-card .card-body canvas {
            max-width: 100%; max-height: 280px; display: none;
        }
        .pipeline-card.done .card-body canvas { display: block; }

        .pipeline-card .card-body .mini-spinner {
            width: 24px; height: 24px;
            border: 2px solid #333; border-top-color: #4a9eff;
            border-radius: 50%; animation: spin 0.8s linear infinite;
            display: none;
        }
        .pipeline-card.active .card-body .mini-spinner { display: block; }

        .pipeline-card .card-footer {
            padding: 5px 10px;
            font-size: 10px; color: #666;
            border-top: 1px solid #2a2a2a;
            text-align: center;
            min-height: 22px;
        }
        .pipeline-card .card-time {
            padding: 3px 10px 5px;
            font-size: 11px; color: #555;
            text-align: center;
            font-variant-numeric: tabular-nums;
        }
        .pipeline-card .card-time:empty { display: none; }
        .pipeline-card.done .card-time { color: #4caf50; }

        /* ViTMatte 6-step pipeline */
        .pipeline-grid.six-steps {
            grid-template-columns: repeat(3, 1fr);
        }
        .pipeline-card.vitmatte-only {
            display: none;
        }
        .pipeline-grid.six-steps .pipeline-card.vitmatte-only {
            display: block;
        }
        .trimap-legend {
            position: absolute;
            bottom: 6px; left: 6px;
            background: rgba(0,0,0,0.7);
            border-radius: 4px;
            padding: 4px 8px;
            display: flex;
            gap: 8px;
            font-size: 10px;
            font-weight: 600;
        }
        .trimap-legend span::before {
            content: '';
            display: inline-block;
            width: 8px; height: 8px;
            border-radius: 2px;
            margin-right: 3px;
            vertical-align: middle;
        }
        .trimap-legend .tl-fg::before { background: #4caf50; }
        .trimap-legend .tl-unk::before { background: #ffeb3b; }
        .trimap-legend .tl-bg::before { background: #555; }

        /* SAM2 Toggle Bar */
        .sam2-toggle-bar {
            background: #1a1a1a;
            border: 1px solid #2a2a2a;
            border-radius: 12px;
            padding: 12px 20px;
            margin-bottom: 12px;
        }

        .sam2-toggle {
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
            user-select: none;
        }

        .sam2-toggle input[type="checkbox"] {
            accent-color: #9c27b0;
            width: 16px;
            height: 16px;
        }

        .sam2-toggle-label {
            font-size: 13px;
            font-weight: 600;
            color: #bbb;
        }

        .sam2-toggle input:checked ~ .sam2-toggle-label {
            color: #ce93d8;
        }

        .sam2-toggle-desc {
            font-size: 11px;
            color: #666;
        }

        .sam2-padding-control {
            display: none;
            align-items: center;
            gap: 10px;
            margin-top: 10px;
            padding-top: 10px;
            border-top: 1px solid #2a2a2a;
        }

        .sam2-padding-control.visible { display: flex; }

        .sam2-sub-options {
            display: none;
            flex-direction: column;
            gap: 8px;
            margin-top: 10px;
            padding-top: 10px;
            border-top: 1px solid #2a2a2a;
        }
        .sam2-sub-options.visible { display: flex; }

        .sam2-sub-option {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .sam2-sub-option input[type="checkbox"] {
            accent-color: #ff9800;
            width: 14px;
            height: 14px;
        }
        .sam2-sub-option .sub-label {
            font-size: 12px;
            font-weight: 600;
            color: #aaa;
        }
        .sam2-sub-option input:checked ~ .sub-label {
            color: #ffb74d;
        }
        .sam2-sub-option .sub-desc {
            font-size: 11px;
            color: #666;
        }

        .sam2-padding-control label {
            font-size: 11px;
            font-weight: 600;
            color: #888;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            white-space: nowrap;
        }

        .sam2-padding-control input[type="range"] {
            flex: 1;
            accent-color: #9c27b0;
            height: 6px;
            max-width: 200px;
        }

        .sam2-padding-value {
            font-size: 13px;
            font-weight: 600;
            color: #ce93d8;
            min-width: 36px;
        }

        /* Object Selection sub-options */
        .objsel-sub-options {
            display: none;
            margin-left: 22px;
            margin-top: 6px;
            padding: 8px 12px;
            background: #1a1a1a;
            border-radius: 8px;
            border: 1px solid #2a2a2a;
        }
        .objsel-sub-options.visible { display: block; }
        .objsel-mode-row {
            display: flex;
            gap: 16px;
            margin-bottom: 8px;
        }
        .objsel-mode-label {
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 12px;
            color: #aaa;
            cursor: pointer;
        }
        .objsel-mode-label input[type="radio"] {
            accent-color: #ff9800;
            width: 13px;
            height: 13px;
        }
        .objsel-mode-label input:checked ~ span {
            color: #ffb74d;
            font-weight: 600;
        }
        .objsel-auto-opts {
            display: none;
            flex-direction: column;
            gap: 6px;
            padding-top: 8px;
            border-top: 1px solid #2a2a2a;
        }
        .objsel-auto-opts.visible { display: flex; }
        .objsel-param {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .objsel-param label {
            font-size: 11px;
            font-weight: 600;
            color: #888;
            min-width: 55px;
            white-space: nowrap;
        }
        .objsel-param input[type="range"] {
            flex: 1;
            accent-color: #ff9800;
            height: 5px;
            max-width: 140px;
        }
        .objsel-param-val {
            font-size: 12px;
            font-weight: 600;
            color: #ffb74d;
            min-width: 32px;
        }
        .objsel-param select {
            background: #222;
            color: #ddd;
            border: 1px solid #444;
            border-radius: 4px;
            padding: 2px 6px;
            font-size: 11px;
        }

        /* ===== Pipeline Compare Test ===== */
        .compare-test {
            background: #1a1a1a;
            border: 1px solid #2a2a2a;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 24px;
        }

        .compare-test-header {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 16px;
            font-size: 15px;
            font-weight: 600;
            color: #ddd;
        }

        .cmp-axis {
            margin-bottom: 12px;
        }

        .cmp-axis-label {
            font-size: 11px;
            font-weight: 600;
            color: #888;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 8px;
        }

        .cmp-checks {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }

        .cmp-check-label {
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 13px;
            color: #bbb;
            cursor: pointer;
            user-select: none;
        }

        .cmp-check-label input[type="checkbox"] {
            accent-color: #4a9eff;
            width: 14px;
            height: 14px;
        }

        .cmp-check-label.disabled {
            opacity: 0.35;
            pointer-events: none;
        }

        .cmp-footer {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-top: 16px;
            padding-top: 12px;
            border-top: 1px solid #2a2a2a;
        }

        .cmp-combo-count {
            font-size: 13px;
            color: #888;
        }

        .cmp-combo-count strong {
            color: #4a9eff;
            font-weight: 700;
        }

        .cmp-run-btn {
            padding: 10px 24px;
            background: #4a9eff;
            color: #fff;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.15s;
        }
        .cmp-run-btn:hover { background: #3a8eef; }
        .cmp-run-btn:disabled {
            opacity: 0.4;
            cursor: not-allowed;
        }

        /* Compare results grid */
        .cmp-results {
            display: none;
            grid-template-columns: repeat(3, 1fr);
            gap: 16px;
            margin-bottom: 24px;
        }
        .cmp-results.visible { display: grid; }

        @media (max-width: 900px) {
            .cmp-results { grid-template-columns: repeat(2, 1fr); }
        }
        @media (max-width: 600px) {
            .cmp-results { grid-template-columns: 1fr; }
        }

        .cmp-card {
            background: #1a1a1a;
            border: 2px solid #2a2a2a;
            border-radius: 12px;
            overflow: hidden;
            transition: border-color 0.3s;
        }
        .cmp-card.pending { border-color: #2a2a2a; }
        .cmp-card.running { border-color: #4a9eff; }
        .cmp-card.done { border-color: #4caf50; }
        .cmp-card.error { border-color: #f44336; }

        .cmp-card-img {
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 200px;
            max-height: 280px;
            overflow: hidden;
            cursor: pointer;
        }

        .cmp-card-img img {
            max-width: 100%;
            max-height: 280px;
            object-fit: contain;
        }

        .cmp-card-img .cmp-spinner {
            width: 28px;
            height: 28px;
            border: 3px solid #333;
            border-top-color: #4a9eff;
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
        }

        .cmp-card-img .cmp-error-icon {
            font-size: 32px;
            color: #f44336;
        }

        .cmp-card-meta {
            padding: 10px 12px;
            border-top: 1px solid #2a2a2a;
        }

        .cmp-pipeline-badges {
            display: flex;
            flex-wrap: wrap;
            gap: 4px;
            margin-bottom: 6px;
        }

        .cmp-badge {
            display: inline-block;
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 11px;
            font-weight: 600;
        }
        .cmp-badge.detect { background: #1a3a5a; color: #64b5f6; }
        .cmp-badge.sam2 { background: #3a2a1a; color: #ffb74d; }
        .cmp-badge.model { background: #1a3a1a; color: #81c784; }

        .cmp-metrics {
            font-size: 12px;
            color: #888;
            line-height: 1.6;
        }
        .cmp-metrics .cmp-error-msg {
            color: #f44336;
            font-size: 11px;
        }

        .cmp-card-dl {
            display: none;
            padding: 8px 12px;
            border-top: 1px solid #2a2a2a;
            text-align: center;
        }
        .cmp-card.done .cmp-card-dl { display: block; }

        .cmp-dl-btn {
            padding: 5px 14px;
            background: #2a8a4a;
            color: #fff;
            border: none;
            border-radius: 6px;
            font-size: 11px;
            font-weight: 600;
            cursor: pointer;
            transition: background 0.15s;
        }
        .cmp-dl-btn:hover { background: #238a42; }

        /* Compare modal */
        .cmp-modal {
            display: none;
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.85);
            z-index: 200;
            align-items: center;
            justify-content: center;
            cursor: zoom-out;
        }
        .cmp-modal.visible { display: flex; }

        .cmp-modal img {
            max-width: 90vw;
            max-height: 90vh;
            object-fit: contain;
            border-radius: 8px;
        }

        .cmp-modal-info {
            position: fixed;
            bottom: 24px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.7);
            color: #ddd;
            padding: 8px 16px;
            border-radius: 8px;
            font-size: 13px;
            pointer-events: none;
        }

        /* ===== Custom Pipeline ===== */
        .cp-section {
            background: #1a1a1a;
            border: 1px solid #2a2a2a;
            border-radius: 12px;
            padding: 12px 20px;
            margin-bottom: 12px;
        }
        .cp-header {
            display: flex;
            align-items: center;
        }
        .cp-toggle {
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
            user-select: none;
        }
        .cp-toggle input[type="checkbox"] {
            accent-color: #00bcd4;
            width: 16px;
            height: 16px;
        }
        .cp-toggle-label {
            font-size: 13px;
            font-weight: 600;
            color: #bbb;
        }
        .cp-toggle input:checked ~ .cp-toggle-label {
            color: #4dd0e1;
        }
        .cp-toggle-desc {
            font-size: 11px;
            color: #666;
        }
        .cp-builder {
            display: none;
            margin-top: 12px;
            padding-top: 12px;
            border-top: 1px solid #2a2a2a;
        }
        .cp-builder.visible { display: block; }
        .cp-chain {
            display: flex;
            gap: 6px;
            align-items: center;
            flex-wrap: wrap;
            margin-bottom: 12px;
        }
        .cp-step {
            display: flex;
            align-items: center;
            gap: 4px;
            position: relative;
        }
        .cp-step select {
            background: #222;
            color: #ddd;
            border: 1px solid #444;
            border-radius: 6px;
            padding: 6px 10px;
            font-size: 12px;
            font-weight: 600;
            cursor: pointer;
            appearance: auto;
        }
        .cp-step select:focus {
            border-color: #4dd0e1;
            outline: none;
        }
        .cp-step-num {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            background: #00bcd4;
            color: #fff;
            font-size: 10px;
            font-weight: 700;
            flex-shrink: 0;
        }
        .cp-step-prompt {
            background: #1a1a1a;
            color: #4dd0e1;
            border: 1px solid #444;
            border-radius: 4px;
            padding: 4px 8px;
            font-size: 11px;
            font-family: monospace;
            width: 120px;
        }
        .cp-step-prompt::placeholder {
            color: #555;
        }
        .cp-step-prompt:focus {
            border-color: #4dd0e1;
            outline: none;
        }
        .cp-help-btn {
            background: none;
            border: 1px solid #555;
            color: #888;
            border-radius: 50%;
            width: 18px;
            height: 18px;
            font-size: 11px;
            line-height: 16px;
            text-align: center;
            cursor: pointer;
            flex-shrink: 0;
            position: relative;
        }
        .cp-help-btn:hover {
            color: #4dd0e1;
            border-color: #4dd0e1;
        }
        .cp-help-popup {
            display: none;
            position: absolute;
            top: calc(100% + 8px);
            left: 50%;
            transform: translateX(-50%);
            background: #1a1a1a;
            border: 1px solid #555;
            border-radius: 8px;
            padding: 14px 16px;
            width: 380px;
            z-index: 1000;
            box-shadow: 0 4px 20px rgba(0,0,0,0.6);
            font-size: 12px;
            line-height: 1.6;
            color: #ccc;
        }
        /* 버튼 → 팝업 사이 갭을 메우는 투명 브릿지 */
        .cp-help-popup::before {
            content: '';
            position: absolute;
            bottom: 100%;
            left: 0;
            width: 100%;
            height: 12px;
        }
        .cp-help-btn:hover .cp-help-popup {
            display: block;
        }
        .cp-help-popup h4 {
            margin: 0 0 6px;
            color: #4dd0e1;
            font-size: 12px;
        }
        .cp-help-popup h4:not(:first-child) {
            margin-top: 10px;
        }
        .cp-help-popup .tag {
            display: inline-block;
            background: #2a2a2a;
            border: 1px solid #444;
            border-radius: 3px;
            padding: 1px 6px;
            margin: 1px 2px;
            font-family: monospace;
            font-size: 11px;
            color: #e0e0e0;
        }
        .cp-help-popup .tag.good { border-color: #4caf50; color: #81c784; }
        .cp-help-popup .tag.warn { border-color: #ff9800; color: #ffb74d; }
        .cp-help-popup .tag.cp-tag-insert {
            cursor: pointer;
            user-select: none;
        }
        .cp-help-popup .tag.cp-tag-insert:hover {
            background: #3a3a3a;
            filter: brightness(1.3);
        }
        .cp-help-popup .tip {
            margin-top: 10px;
            padding-top: 8px;
            border-top: 1px solid #333;
            color: #999;
            font-size: 11px;
        }
        .cp-help-popup .tip code {
            color: #4dd0e1;
            background: #2a2a2a;
            padding: 1px 4px;
            border-radius: 2px;
        }
        .cp-step-params {
            display: flex;
            gap: 4px;
            align-items: center;
        }
        .cp-step-params label {
            display: flex;
            align-items: center;
            gap: 3px;
            font-size: 10px;
            color: #888;
            cursor: help;
        }
        .cp-step-params input[type="number"] {
            background: #1a1a1a;
            color: #ce93d8;
            border: 1px solid #444;
            border-radius: 4px;
            padding: 3px 4px;
            font-size: 11px;
            font-family: monospace;
            width: 42px;
            text-align: center;
        }
        .cp-step-params input[type="number"]:focus {
            border-color: #ce93d8;
            outline: none;
        }
        .cp-step-params select {
            background: #1a1a1a;
            color: #ffb74d;
            border: 1px solid #444;
            border-radius: 4px;
            padding: 3px 4px;
            font-size: 11px;
            cursor: pointer;
        }
        .cp-step-params select:focus {
            border-color: #ffb74d;
            outline: none;
        }
        .cp-step-del {
            background: none;
            border: none;
            color: #666;
            font-size: 14px;
            cursor: pointer;
            padding: 2px 4px;
            line-height: 1;
            border-radius: 4px;
        }
        .cp-step-del:hover {
            color: #f44336;
            background: rgba(244, 67, 54, 0.15);
        }
        .cp-arrow {
            color: #555;
            font-size: 14px;
            margin: 0 2px;
            flex-shrink: 0;
        }
        .cp-add-btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            border: 2px dashed #444;
            background: transparent;
            color: #888;
            font-size: 18px;
            cursor: pointer;
            transition: all 0.15s;
            flex-shrink: 0;
        }
        .cp-add-btn:hover {
            border-color: #4dd0e1;
            color: #4dd0e1;
        }
        .cp-actions {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-top: 12px;
        }
        .cp-run-btn {
            padding: 10px 24px;
            background: #00bcd4;
            color: #fff;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.15s;
        }
        .cp-run-btn:hover { background: #00acc1; }
        .cp-run-btn:disabled {
            opacity: 0.4;
            cursor: not-allowed;
        }

        /* CPX: CP Compare */
        .cpx-add-btn {
            padding: 8px 16px;
            background: #2a5a8a;
            color: #fff;
            border: none;
            border-radius: 8px;
            font-size: 13px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.15s;
        }
        .cpx-add-btn:hover { background: #3a6a9a; }

        .cp-clear-btn {
            padding: 8px 16px;
            background: #555;
            color: #ccc;
            border: none;
            border-radius: 8px;
            font-size: 13px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.15s;
        }
        .cp-clear-btn:hover { background: #777; color: #fff; }

        .cpx-section {
            background: #1a1a2a;
            border: 1px solid #2a3a5a;
            border-radius: 12px;
            padding: 16px 20px;
            margin-bottom: 12px;
        }
        .cpx-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 12px;
        }
        .cpx-title {
            font-size: 15px;
            font-weight: 600;
            color: #8ab4f8;
        }
        .cpx-count {
            font-size: 12px;
            color: #888;
        }
        .cpx-slots {
            display: flex;
            flex-direction: column;
            gap: 8px;
            margin-bottom: 12px;
        }
        .cpx-slot {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 12px;
            background: #111;
            border: 1px solid #2a2a2a;
            border-radius: 8px;
        }
        .cpx-slot-num {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: 700;
            color: #fff;
            flex-shrink: 0;
        }
        .cpx-slot:nth-child(1) .cpx-slot-num { background: #2a6aff; }
        .cpx-slot:nth-child(2) .cpx-slot-num { background: #ff8a2a; }
        .cpx-slot:nth-child(3) .cpx-slot-num { background: #2aaa5a; }
        .cpx-slot:nth-child(4) .cpx-slot-num { background: #e040fb; }
        .cpx-slot:nth-child(5) .cpx-slot-num { background: #ff5252; }
        .cpx-slot:nth-child(6) .cpx-slot-num { background: #ffd740; }
        .cpx-slot-chain {
            display: flex;
            flex-wrap: wrap;
            gap: 4px;
            flex: 1;
        }
        .cpx-slot-badge {
            display: inline-block;
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 11px;
            font-weight: 600;
            background: #1a2a3a;
            color: #8ab4f8;
        }
        .cpx-slot-badge .cpx-param {
            font-weight: 400;
            color: #666;
            margin-left: 2px;
        }
        .cpx-slot-del {
            background: none;
            border: none;
            color: #666;
            font-size: 16px;
            cursor: pointer;
            padding: 2px 6px;
            border-radius: 4px;
        }
        .cpx-slot-del:hover { color: #f44336; background: #2a1a1a; }
        .cpx-actions {
            display: flex;
            gap: 8px;
            padding-top: 8px;
            border-top: 1px solid #2a2a3a;
        }
        .cpx-run-btn {
            padding: 10px 24px;
            background: #4a9eff;
            color: #fff;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.15s;
        }
        .cpx-run-btn:hover { background: #3a8eef; }
        .cpx-run-btn:disabled { opacity: 0.4; cursor: not-allowed; }
        .cpx-clear-btn {
            padding: 10px 16px;
            background: transparent;
            color: #888;
            border: 1px solid #333;
            border-radius: 8px;
            font-size: 13px;
            cursor: pointer;
            transition: all 0.15s;
        }
        .cpx-clear-btn:hover { color: #f44336; border-color: #f44336; }
        .cpx-res-toggle {
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 13px;
            color: #aaa;
            cursor: pointer;
            user-select: none;
        }
        .cpx-res-toggle input { accent-color: #4a9eff; }

        .cpx-pipeline-group {
            margin-bottom: 16px;
        }
        .cpx-pipeline-label {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 8px;
            font-size: 13px;
            font-weight: 600;
        }
        .cpx-pipeline-num {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 11px;
            font-weight: 700;
            color: #fff;
        }
        .cpx-pipeline-group:nth-child(1) .cpx-pipeline-num { background: #2a6aff; }
        .cpx-pipeline-group:nth-child(2) .cpx-pipeline-num { background: #ff8a2a; }
        .cpx-pipeline-group:nth-child(3) .cpx-pipeline-num { background: #2aaa5a; }
        .cpx-pipeline-group:nth-child(4) .cpx-pipeline-num { background: #e040fb; }
        .cpx-pipeline-group:nth-child(5) .cpx-pipeline-num { background: #ff5252; }
        .cpx-pipeline-group:nth-child(6) .cpx-pipeline-num { background: #ffd740; }
        .cpx-pipeline-group:nth-child(1) .cpx-pipeline-label { color: #8ab4f8; }
        .cpx-pipeline-group:nth-child(2) .cpx-pipeline-label { color: #ffb74d; }
        .cpx-pipeline-group:nth-child(3) .cpx-pipeline-label { color: #81c784; }
        .cpx-pipeline-group:nth-child(4) .cpx-pipeline-label { color: #e040fb; }
        .cpx-pipeline-group:nth-child(5) .cpx-pipeline-label { color: #ff5252; }
        .cpx-pipeline-group:nth-child(6) .cpx-pipeline-label { color: #ffd740; }

        /* Object Selection container */
        .objsel-container {
            display: none;
            background: #1a1a1a;
            border: 1px solid #2a2a2a;
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 20px;
        }
        .objsel-container.visible { display: block; }
        .objsel-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
            font-size: 14px;
            font-weight: 600;
            color: #ddd;
        }
        .objsel-hint {
            font-size: 12px;
            font-weight: 400;
            color: #4dd0e1;
        }
        .objsel-body {
            text-align: center;
        }
        .objsel-body canvas {
            max-width: 100%;
            max-height: 500px;
            cursor: pointer;
            border-radius: 8px;
        }
        .objsel-footer {
            margin-top: 8px;
            font-size: 12px;
            color: #888;
            text-align: center;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>배경 제거 프로토타입</h1>
            <p>7개 모델 비교 테스트 (BiRefNet / RMBG2 / BEN2 / remove.bg)</p>
        </header>

        <!-- Upload Area -->
        <div id="upload-area" class="upload-area">
            <div class="upload-prompt">
                <div class="icon">+</div>
                <div class="label">이미지를 드래그하거나 클릭하여 선택</div>
                <div class="hint">JPG, PNG, WebP, HEIC (최대 20MB)</div>
            </div>
            <div class="file-info">
                <span class="file-name" id="file-name"></span>
                <span class="change-btn">변경</span>
            </div>
        </div>
        <input type="file" id="file-input" accept="image/*,.heic,.heif" hidden>

        <!-- Error Message -->
        <div id="error-message" class="error-message"></div>

        <!-- SAM2 Toggle -->
        <div class="sam2-toggle-bar">
            <label class="sam2-toggle">
                <input type="checkbox" id="sam2-check">
                <span class="sam2-toggle-label">SAM2 전처리 (어른 제거)</span>
                <span class="sam2-toggle-desc">— ON 시 SAM2로 아이 영역 크롭 후 선택 모델로 배경 제거</span>
            </label>
            <div class="sam2-sub-options" id="sam2-sub-options">
                <label class="sam2-sub-option">
                    <input type="checkbox" id="gdino-check">
                    <span class="sub-label">Grounding DINO</span>
                    <span class="sub-desc">— face-api 대신 텍스트 기반 아이 감지</span>
                </label>
                <label class="sam2-sub-option">
                    <input type="checkbox" id="vitmatte-check">
                    <span class="sub-label">ViTMatte</span>
                    <span class="sub-desc">— 머리카락 등 정밀 알파 매팅 (bg-removal 모델 대체)</span>
                </label>
                <label class="sam2-sub-option">
                    <input type="checkbox" id="objsel-check">
                    <span class="sub-label">오브젝트 선택</span>
                    <span class="sub-desc">— 클릭 또는 자동으로 오브젝트 선택</span>
                </label>
                <div class="objsel-sub-options" id="objsel-sub-options">
                    <div class="objsel-mode-row">
                        <label class="objsel-mode-label">
                            <input type="radio" name="objsel-mode" value="click" checked>
                            <span>클릭 세그먼트</span>
                        </label>
                        <label class="objsel-mode-label">
                            <input type="radio" name="objsel-mode" value="auto">
                            <span>자동 세그먼트</span>
                        </label>
                    </div>
                    <div class="objsel-auto-opts" id="objsel-auto-opts">
                        <div class="objsel-param">
                            <label>최소 크기</label>
                            <input type="range" id="objsel-min-area" min="0.5" max="10" value="2" step="0.5">
                            <span class="objsel-param-val" id="objsel-min-area-val">2%</span>
                        </div>
                        <div class="objsel-param">
                            <label>최대 개수</label>
                            <select id="objsel-max-masks">
                                <option value="10">10개</option>
                                <option value="20" selected>20개</option>
                                <option value="30">30개</option>
                                <option value="50">50개</option>
                            </select>
                        </div>
                    </div>
                </div>
            </div>
            <div class="sam2-padding-control" id="sam2-padding-control">
                <label>크롭 패딩</label>
                <input type="range" id="sam2-padding-slider" min="0" max="40" value="15" step="1">
                <span class="sam2-padding-value" id="sam2-padding-value">15%</span>
            </div>
        </div>

        <!-- Custom Pipeline -->
        <div class="cp-section" id="cp-section">
            <div class="cp-header">
                <label class="cp-toggle">
                    <input type="checkbox" id="cp-check">
                    <span class="cp-toggle-label">커스텀 파이프라인</span>
                    <span class="cp-toggle-desc">— 처리 단계를 직접 조합</span>
                </label>
            </div>
            <div class="cp-builder" id="cp-builder">
                <div class="cp-chain" id="cp-chain"></div>
                <button class="cp-add-btn" id="cp-add-btn">+</button>
                <div class="cp-actions">
                    <button class="cp-run-btn" id="cp-run-btn" disabled>파이프라인 실행</button>
                    <button class="cp-clear-btn" id="cp-clear-btn">결과 초기화</button>
                    <button class="cpx-add-btn" id="cpx-add-btn">+ 비교 추가</button>
                </div>
            </div>
        </div>

        <!-- CPX: CP Compare -->
        <div class="cpx-section" id="cpx-section" style="display:none;">
            <div class="cpx-header">
                <span class="cpx-title">CP 비교</span>
                <span class="cpx-count" id="cpx-count">0개 슬롯</span>
            </div>
            <div class="cpx-slots" id="cpx-slots"></div>
            <div class="cpx-actions">
                <button class="cpx-run-btn" id="cpx-run-btn" disabled>비교 실행</button>
                <label class="cpx-res-toggle"><input type="checkbox" id="cpx-original-check"><span>원본 해상도</span></label>
                <button class="cpx-clear-btn" id="cpx-clear-btn">초기화</button>
            </div>
        </div>
        <div id="cpx-results" class="cmp-results"></div>
        <div id="cpx-pipelines"></div>

        <!-- Controls -->
        <div class="controls">
            <div class="control-group">
                <label>모델 선택</label>
                <div class="model-options">
                    <input type="radio" name="model" id="m-portrait" value="portrait" checked>
                    <label for="m-portrait" class="model-label">Portrait</label>

                    <input type="radio" name="model" id="m-hr" value="hr">
                    <label for="m-hr" class="model-label">HR</label>

                    <input type="radio" name="model" id="m-hr-matting" value="hr-matting">
                    <label for="m-hr-matting" class="model-label">HR-Matting</label>

                    <input type="radio" name="model" id="m-dynamic" value="dynamic">
                    <label for="m-dynamic" class="model-label">Dynamic</label>

                    <input type="radio" name="model" id="m-rmbg2" value="rmbg2">
                    <label for="m-rmbg2" class="model-label">RMBG2</label>

                    <input type="radio" name="model" id="m-ben2" value="ben2">
                    <label for="m-ben2" class="model-label">BEN2</label>

                    <input type="radio" name="model" id="m-removebg" value="removebg">
                    <label for="m-removebg" class="model-label" style="border-color:#4a6; color:#4a6;">remove.bg</label>
                </div>
            </div>

            <div class="control-group">
                <label>처리 해상도</label>
                <div class="resolution-control" id="resolution-control">
                    <input type="range" id="resolution-slider" min="512" max="2560" value="1440" step="64">
                    <span class="res-value" id="res-value">1440px</span>
                    <label class="original-toggle">
                        <input type="checkbox" id="original-check">원본
                    </label>
                </div>
            </div>



        </div>

        <!-- Pipeline Compare Test -->
        <div id="compare-test" class="compare-test" style="display:none;">
            <div class="compare-test-header">파이프라인 비교</div>

            <div class="cmp-axis">
                <div class="cmp-axis-label">감지 방식</div>
                <div class="cmp-checks" id="cmp-detect-checks">
                    <label class="cmp-check-label"><input type="checkbox" value="none" checked><span>없음 (직접)</span></label>
                    <label class="cmp-check-label"><input type="checkbox" value="faceapi" checked><span>face-api</span></label>
                    <label class="cmp-check-label"><input type="checkbox" value="dino"><span>DINO</span></label>
                </div>
            </div>

            <div class="cmp-axis">
                <div class="cmp-axis-label">BG 모델</div>
                <div class="cmp-checks" id="cmp-model-checks">
                    <label class="cmp-check-label"><input type="checkbox" value="portrait" checked><span>portrait</span></label>
                    <label class="cmp-check-label"><input type="checkbox" value="hr"><span>hr</span></label>
                    <label class="cmp-check-label"><input type="checkbox" value="hr-matting"><span>hr-matting</span></label>
                    <label class="cmp-check-label"><input type="checkbox" value="dynamic"><span>dynamic</span></label>
                    <label class="cmp-check-label"><input type="checkbox" value="rmbg2"><span>rmbg2</span></label>
                    <label class="cmp-check-label"><input type="checkbox" value="ben2" checked><span>ben2</span></label>
                    <label class="cmp-check-label"><input type="checkbox" value="removebg"><span>remove.bg</span></label>
                    <label class="cmp-check-label"><input type="checkbox" value="vitmatte"><span>ViTMatte</span></label>
                </div>
            </div>

            <div class="cmp-footer">
                <span class="cmp-combo-count" id="cmp-combo-count">총 <strong>0</strong>개 조합</span>
                <button class="cmp-run-btn" id="cmp-run-btn" disabled>비교 실행</button>
            </div>
        </div>

        <!-- Compare Results Grid -->
        <div id="cmp-results" class="cmp-results"></div>

        <!-- Compare Modal -->
        <div id="cmp-modal" class="cmp-modal">
            <img id="cmp-modal-img" src="" alt="enlarged">
            <div class="cmp-modal-info" id="cmp-modal-info"></div>
        </div>

        <!-- Compare: Original vs Result -->
        <div id="compare-section" class="compare-section">
            <div class="compare-card">
                <div class="card-title">원본 이미지</div>
                <div class="card-body">
                    <img id="original-preview" alt="원본">
                </div>
            </div>
            <div class="compare-card">
                <div class="card-title">배경 제거 결과</div>
                <div class="card-body checker-bg">
                    <canvas id="result-canvas"></canvas>
                </div>
            </div>
        </div>

        <!-- Object Selection -->
        <div id="objsel-container" class="objsel-container">
            <div class="objsel-header">
                <span>오브젝트 선택</span>
                <span id="objsel-hint" class="objsel-hint">오브젝트를 클릭하여 선택하세요</span>
            </div>
            <div id="objsel-body" class="objsel-body">
                <canvas id="objsel-canvas"></canvas>
            </div>
            <div id="objsel-footer" class="objsel-footer"></div>
        </div>

        <!-- SAM2 Pipeline -->
        <div id="sam2-pipeline" class="sam2-pipeline">
            <div class="pipeline-title">SAM2 세그멘테이션 파이프라인</div>
            <div class="pipeline-grid">
                <div class="pipeline-card" id="pipe-face">
                    <div class="card-header">
                        <span class="step-num">1</span>
                        <span class="step-title">얼굴 감지</span>
                        <span class="step-status" id="pipe-face-status"></span>
                    </div>
                    <div class="card-body">
                        <div class="mini-spinner"></div>
                        <canvas id="pipe-face-canvas"></canvas>
                    </div>
                    <div class="card-footer" id="pipe-face-info"></div>
                </div>
                <div class="pipeline-card" id="pipe-points">
                    <div class="card-header">
                        <span class="step-num">2</span>
                        <span class="step-title">포인트 프롬프트</span>
                        <span class="step-status" id="pipe-points-status"></span>
                    </div>
                    <div class="card-body">
                        <div class="mini-spinner"></div>
                        <canvas id="pipe-points-canvas"></canvas>
                    </div>
                    <div class="card-footer" id="pipe-points-info"></div>
                </div>
                <div class="pipeline-card" id="pipe-mask">
                    <div class="card-header">
                        <span class="step-num">3</span>
                        <span class="step-title">SAM2 마스크</span>
                        <span class="step-status" id="pipe-mask-status"></span>
                    </div>
                    <div class="card-body">
                        <div class="mini-spinner"></div>
                        <canvas id="pipe-mask-canvas"></canvas>
                    </div>
                    <div class="card-footer" id="pipe-mask-info"></div>
                </div>
                <div class="pipeline-card vitmatte-only" id="pipe-trimap">
                    <div class="card-header">
                        <span class="step-num">4</span>
                        <span class="step-title">Trimap</span>
                        <span class="step-status" id="pipe-trimap-status"></span>
                    </div>
                    <div class="card-body">
                        <div class="mini-spinner"></div>
                        <canvas id="pipe-trimap-canvas"></canvas>
                    </div>
                    <div class="card-footer" id="pipe-trimap-info"></div>
                </div>
                <div class="pipeline-card vitmatte-only" id="pipe-alpha">
                    <div class="card-header">
                        <span class="step-num">5</span>
                        <span class="step-title">Alpha Matte</span>
                        <span class="step-status" id="pipe-alpha-status"></span>
                    </div>
                    <div class="card-body">
                        <div class="mini-spinner"></div>
                        <canvas id="pipe-alpha-canvas"></canvas>
                    </div>
                    <div class="card-footer" id="pipe-alpha-info"></div>
                </div>
                <div class="pipeline-card" id="pipe-result">
                    <div class="card-header">
                        <span class="step-num" id="pipe-result-num">4</span>
                        <span class="step-title">배경 제거</span>
                        <span class="step-status" id="pipe-result-status"></span>
                    </div>
                    <div class="card-body checker-bg">
                        <div class="mini-spinner"></div>
                        <canvas id="pipe-result-canvas"></canvas>
                    </div>
                    <div class="card-footer" id="pipe-result-info"></div>
                </div>
            </div>
        </div>

        <!-- BGQA Badge -->
        <div id="bgqa-badge" class="bgqa-badge"></div>

        <!-- Processing Info -->
        <div id="processing-info" class="processing-info"></div>

        <!-- 3-way Preview -->
        <div id="preview-section" class="preview-section">
            <div class="section-title">배경색 미리보기</div>
            <div class="preview-grid">
                <div class="preview-card">
                    <div class="preview-label">흰색 배경</div>
                    <canvas id="preview-white"></canvas>
                </div>
                <div class="preview-card">
                    <div class="preview-label">회색 배경</div>
                    <canvas id="preview-gray"></canvas>
                </div>
                <div class="preview-card">
                    <div class="preview-label">검정 배경</div>
                    <canvas id="preview-black"></canvas>
                </div>
            </div>
        </div>

        <!-- Download -->
        <div id="download-section" class="download-section">
            <button id="download-btn" class="download-btn">PNG 다운로드 (투명 배경)</button>
            <button id="download-crop-btn" class="download-btn download-crop-btn" style="display:none;">JPG 다운로드 (SAM2 크롭)</button>
        </div>
    </div>

    <!-- Loading Overlay -->
    <div id="loading-overlay" class="loading-overlay">
        <div class="spinner"></div>
        <div class="loading-text">배경을 제거하고 있습니다...</div>
        <div class="loading-time" id="loading-time"></div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/@vladmandic/face-api/dist/face-api.js"></script>
    <script src="js/pipeline-core.js"></script>
    <script type="module" src="js/bgRemoveApp.js"></script>
</body>
</html>
